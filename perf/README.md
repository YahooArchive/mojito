# Performance Testing

work in progress


## Running
* use `mp-run.pl {recipe}` to gather results
* recipe file described below
* it uses `ab` so that needs to be installed
* it uses the `JSON::XS` perl module, so that needs to be installed
* raw results go into a directory with the same name as the recipe (minus the `.json` extension)
* one file per run

example:
```
$ ./mp-run.pl v3.json
```


## Recipe File
* is a JSON file (see example files)
* key `url` (string) specifies which URL to test
* key `target` (object) is arbitrary metadata about the target being tested
* key `harness` (object) has details on *how* to run the tests
    * `requests` is the number of requests to perform
    * `concurrency` is how many requests to have in-flight at one time
    * `warmupRequests` is the number of requests to perform before we start gathering stats

## Refining the Raw Results
* use `mp-refine.pl {files}` to turn raw results into CSV file
* output is to stdout

example:
```
$ ./mp-refine.pl v3/*.raw > v3.csv
```


## Comparing Runs
You can use the CSV file generated by `mp-refine.pl` in your favorite spreadsheet software.
Or, using the grapher below.


## Graphing Results
* draw different kinds of graphs, using the "refined" files
* all graphs are in SVG format


### "basics" Graph
* plots requests-per-second and microseconds-per-request
* can plot multiple files

example:
```
./mp-graph.pl basics <(./mp-refine.pl v3/*.raw) <(./mp-refine.pl v4/*.raw) > basics.svg
```


### "conntotal" Graph
* plots connection times

currently unimplemented


### "pctserved" Graph
* plots time required to complete various percentages of the traffic

currently unimplemented


